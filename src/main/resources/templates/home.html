<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Личный кабинет</title>

    <!-- LIBRARIES -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

    <script>
        const token = localStorage.getItem("token");
        const userURI = localStorage.getItem("userURI");

        if ((token === null) || (userURI === null)) {
            window.location.replace('/login');
        } else {
            $.ajax({
                type: 'GET',
                url: userURI,
                dataType: 'json',
                beforeSend: function (jqXHR, settings) {
                    jqXHR.setRequestHeader('Authorization', token);
                },
                success: function (data, textStatus, jqXHR) {
                    console.log('Accepted: ', data);

                    $('#login').empty()
                        .append(data.login);

                    $('#full-name').empty()
                        .append(data.name).append(' ')
                        .append(data.surname).append(' ')
                        .append(data.patronymic);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log('Unexpected error:', jqXHR.statusCode);
                }
            })
        }

        $(function () {
            $('#logout').on("click", function () {
                localStorage.removeItem('token');
                localStorage.removeItem('userURI');
                window.location.replace('/login');
            });
        });
    </script>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-4" style="padding-top: 25px">
            <h1>Личный кабинет</h1>
            <p id="login" class="h3" style="display: inline"></p>
            <a id="logout" class="btn btn-danger"
               style="color: white; font-weight: bold; margin-left: 10px; margin-bottom: 10px">выйти</a>
            <p id="full-name" style="font-size: 25px"></p>
        </div>
    </div>
</div>
</body>
</html>